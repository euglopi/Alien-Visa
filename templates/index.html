{% extends "base.html" %}

{% block title %}Upload Resume - O-1 Visa Readiness Analyzer{% endblock %}

{% block content %}
<!-- Loading Overlay -->
<div id="loading-overlay" class="fixed inset-0 bg-gray-900/80 backdrop-blur-sm hidden items-center justify-center z-50">
    <div class="text-center">
        <!-- Pulsing Alien -->
        <style>
            @keyframes pulse-zoom {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.15); }
            }
            .animate-pulse-zoom {
                animation: pulse-zoom 1.2s ease-in-out infinite;
            }
        </style>
        <img src="/static/alien.png" alt="Analyzing..." class="h-24 mx-auto animate-pulse-zoom mb-6">

        <h2 class="text-2xl font-semibold text-white mb-3">Analyzing your resume</h2>
        <p id="loading-subtitle" class="text-lg text-blue-200 transition-opacity duration-300">
            Uploading document...
        </p>
    </div>
</div>

<div class="min-h-screen flex flex-col items-center justify-center px-4">
    <div class="max-w-xl w-full">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">O-1 Visa Readiness Analyzer</h1>
            <p class="text-lg text-gray-600">
                Choose how you want to start: upload your resume for a full criteria assessment,
                or jump straight into finding mentors and experts.
            </p>
        </div>

        <div class="grid gap-6">
            <!-- Option 1: Analyze resume -->
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-lg font-semibold text-gray-900 mb-2">Analyze my resume</h2>
                <p class="text-sm text-gray-600 mb-4">
                    Upload your resume to see how your profile maps to the 8 O-1A criteria.
                </p>
                <form id="upload-form" action="/upload" method="post" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="resume" class="block text-sm font-medium text-gray-700 mb-2">
                            Upload your resume
                        </label>
                        <input
                            type="file"
                            id="resume"
                            name="resume"
                            accept=".pdf,.docx"
                            required
                            class="block w-full text-sm text-gray-500
                                file:mr-4 file:py-2 file:px-4
                                file:rounded-md file:border-0
                                file:text-sm file:font-semibold
                                file:bg-blue-50 file:text-blue-700
                                hover:file:bg-blue-100
                                cursor-pointer"
                        >
                        <p class="mt-2 text-sm text-gray-500">PDF or DOCX files accepted</p>
                    </div>

                    <button
                        type="submit"
                        class="w-full bg-blue-600 text-white py-3 px-4 rounded-md font-medium
                            hover:bg-blue-700 transition-colors"
                    >
                        Analyze My Resume
                    </button>
                </form>
            </div>

            <!-- Option 2: Find mentors without uploading -->
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-lg font-semibold text-gray-900 mb-2">Find mentors and experts</h2>
                <p class="text-sm text-gray-600 mb-4">
                    Browse successful O-1 holders and expert letter writers, even if you’re not ready to upload a resume yet.
                </p>
                <div class="flex flex-col sm:flex-row gap-3">
                    <a
                        href="/mentors"
                        class="flex-1 inline-flex items-center justify-center rounded-md border border-blue-600 text-blue-600 px-4 py-2 text-sm font-medium hover:bg-blue-50 transition-colors"
                    >
                        Browse mentors
                    </a>
                    <a
                        href="/experts"
                        class="flex-1 inline-flex items-center justify-center rounded-md border border-gray-300 text-gray-700 px-4 py-2 text-sm font-medium hover:bg-gray-50 transition-colors"
                    >
                        Find expert letter writers
                    </a>
                </div>
                <a
                    href="/community"
                    class="mt-3 inline-flex items-center text-xs text-gray-500 hover:text-gray-700"
                >
                    Explore community stories and Q&A →
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    const subtitles = [
        "Uploading document...",
        "Parsing resume content...",
        "Extracting work experience...",
        "Analyzing achievements...",
        "Matching against O-1A criteria...",
        "Evaluating extraordinary ability...",
        "Preparing your results..."
    ];

    let currentIndex = 0;
    const subtitleEl = document.getElementById('loading-subtitle');
    const overlay = document.getElementById('loading-overlay');
    const form = document.getElementById('upload-form');

    function cycleSubtitle() {
        subtitleEl.style.opacity = '0';
        setTimeout(() => {
            currentIndex = (currentIndex + 1) % subtitles.length;
            subtitleEl.textContent = subtitles[currentIndex];
            subtitleEl.style.opacity = '1';
        }, 300);
    }

    form.addEventListener('submit', function() {
        overlay.classList.remove('hidden');
        overlay.classList.add('flex');
        setInterval(cycleSubtitle, 2000);
    });
</script>
{% endblock %}
